generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
  env = "../../.env"
}

datasource db {
  provider = "postgresql"
}


model User{
  id            String  @id   @default(uuid())
  email         String    @unique
  password      String
  credits       Int       @default(0)
  apiKeys       ApiKey[]
  onrampTransaction   OnrampTransaction[]
  conversations   Conversation[]
}

model ApiKey{
  id          String  @id   @default(uuid())
  userId      String
  apiKey      String
  name        String    @unique
  disable     Boolean   @default(false)
  deleted     Boolean   @default(false)
  lastUsed    DateTime?
  creditconsumed Int    @default(0)
  user        User      @relation(fields: [userId], references: [id])
  conversation    Conversation[]
}

model Company{
  id        String  @id   @default(uuid())
  name      String
  website   String
  models    Model[]
}

model Model{
  id                      String  @id   @default(uuid())
  name                    String
  companyId               String
  slug                    String
  company                 Company     @relation(fields: [companyId], references: [id])
  modelProviderMapping    ModelProviderMapping[]
}

model Provider{
  id        String  @id   @default(uuid())
  name      String
  website   String
  modelProviderMapping    ModelProviderMapping[]
}

model ModelProviderMapping{
  id                String  @id   @default(uuid())
  modelId           String
  providerId        String
  inputTokenCost    Int
  outputTokenCost   Int
  model             Model       @relation(fields: [modelId], references: [id])
  provider          Provider    @relation(fields: [providerId], references: [id])
  conversation      Conversation[]
}

model OnrampTransaction{
  id          String  @id   @default(uuid())
  userId      String
  amount      Int
  status      String
  user        User    @relation(fields: [userId], references: [id])
}

model Conversation{
  id                        String  @id   @default(uuid())
  userId                    String
  apiKeyId                  String
  modelProviderMappingId    String
  input                     String
  output                    String
  inputTokenCount           Int
  outputTokenCount          Int
  user                      User    @relation(fields: [userId], references: [id])
  apiKey                    ApiKey      @relation(fields: [apiKeyId], references: [id])
  modelProviderMapping      ModelProviderMapping    @relation(fields: [modelProviderMappingId], references: [id])
}
